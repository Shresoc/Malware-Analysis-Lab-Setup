# Malware-Analysis-Lab-Setup
Dynamic malware analysis dedicated lab environment equipped with VMs, software tools, and gateways
![LAb Setup](https://github.com/Shresoc/Malware-Analysis-Lab-Setup/assets/168186856/fe0c7f0f-bcc0-4fba-bfee-5c4383259af6)


## VM Setup
Any malware is dangerous and could leave a major damage if it
gets executed on the host system. An isolated environment is required for the
analysis to proceed for any particular malware. A malware analysis lab helps in
decreasing the risk of infection, helps you to control output/input of your network,
and also helps in speeding up the analysis.

## Oracle Virtual Box-
In this particular lab setup, we have taken oracle
virtual box into consideration as it is pretty easy to install, configure and it could
even load multiple of operating systems. It consists of wide variety of features and
is even cost free on the internet. Virtual Box even produces an unlimited number
of snapshots which is hard to find in other virtual machines. Hence, Oracle Virtual
Box, Version- 6.1.12.

## Operating System-
Windows 10 ( Victimâ€™s Virtual Machine), for the
particular setup, a 64-bit Windows 10 will be used as the main target machine
which we would be isolating. As we all know Windows 10 is one of the most
popular OS, it would be interesting to observe how a malware acts in it when it is
present in a vulnerable state, that is when the firewall and the windows defender
has been turned off. In due course of time malwares have also updated
themselves, which means they could understand if they are being analyzed in a
virtual machine. So, we need to make our target VM as realistic as possible, so
that the malware could think it is in a genuine host system.

## System Configuration:
Windows 10X64bits
RAM: 4GB
CPUs: 4
IP Address: 192.168.0.105


## Software Tools:
The following major applications were installed on the windows virtual machine,
Firefox, Chrome, Fakenet, Winrar and adobe reader. A plugin known as Adobe Flash
Player was also used as it is utilized by many different browsers to view various
visual and digital contents and even for playing online games. This makes it prone to
malicious code as it could be injected and also introduced into the system. Many other
nonprimary tools were of no use but were installed just to portray the system being
real or a host system.

## Analysis Tools:

I. Wireshark-
Wireshark is a kind of packet tracing application which helps in analyzing the
packets in more depth. If ever there is a malware downloaded or present in the system
it alarms the user and also helps in identifying anything suspicious.

II. Process Monitor-
It is a tool present in the windows OS which helps to monitor and keep a check on the
various activities, processes and different file systems. It helps in bypassing different
problems regarding malware analysis and forensics, which makes this tool valuable for use. It provides a virtual output of the file systems, processes and all the other
activities on the system.


## Gateway;

Fakenet is used here to simulate a real internet connection on our Windows VM.
There is no active internet connection, but a simulation of it. This is installed on our
windows VM so that any malware which is used for the analysis will have an
impression that you are proactively connected to the internet. We can download
Fakenet for free from the internet, Fakenet has to be run as an administrator. Once we
run it, it modifies the DNS settings and also allows to simulate connection. This
means if you open up any web browser, Firefox in this case and load any website, for
instance www.google.com. It results in giving a warning page and provide a tab to
view a page certificate. By clicking on the certificate it redirects you to a success
page, simulating a fake internet connection to fool the malware. By editing the
configuration files of the Fakenet, this allows you to dump the output and essentially
stores all the packets in a p-cap file. So if we run the Fakenet application again all the
request will logged for us in the p-cap file for any malware that we are analyzing.

## Lab Testing

Isolation test- Windows VM and the host windows OS were checked if there is a
connection between them through the internet, resulting in negative when pinged.

![Isolation Test](https://github.com/Shresoc/Malware-Analysis-Lab-Setup/assets/168186856/c86745b5-00d6-47de-901a-cdbe65456be2)

![Disabled Firewall](https://github.com/Shresoc/Malware-Analysis-Lab-Setup/assets/168186856/8eedd47c-1e51-46bf-b8d4-acc1cf4abc5f)

![Isolation 2](https://github.com/Shresoc/Malware-Analysis-Lab-Setup/assets/168186856/4ea81828-16c7-4d7a-9e6e-8b4dc39d489f)

## Dumping of outputs is shown:

![Dumping of Output](https://github.com/Shresoc/Malware-Analysis-Lab-Setup/assets/168186856/4ef88151-6a6f-4c49-a1f7-c7155e71df38)

## Configuration of Fakenet:

![Fakenet](https://github.com/Shresoc/Malware-Analysis-Lab-Setup/assets/168186856/2e3f71a7-0e91-4c23-a2f1-4158e644aa19)

## New port and connection requests:

![new port and connection requests](https://github.com/Shresoc/Malware-Analysis-Lab-Setup/assets/168186856/8345990d-76b9-44c0-b129-797c4dbcc242)

## Redirection to a success page of a stimulated connection:

![Last](https://github.com/Shresoc/Malware-Analysis-Lab-Setup/assets/168186856/6605714c-0560-4906-b02f-0e0f70a5c0c3)







